var campusMap="Building/(Campus)/campus.html",building2=["Building/2000/First-Floor.html"],building3=["Building/3000/First-Floor.html","Building/3000/Second-Floor.html","Building/3000/Third-Floor.html","Building/3000/Fourth-Floor.html"],buildingA=["Building/A/First-Floor.html"],buildingB=["Building/B/first-floor.html","Building/B/second-floor.html","Building/B/third-floor.html"],buildingC=["Building/C/First-Floor.html","Building/C/Second-Floor.html"],buildingC3=["Building/C3/Ground-Floor.html","Building/C3/First-Floor.html","Building/C3/Second-Floor.html"],buildingD=["Building/D/First-Floor.html","Building/D/Second-Floor.html"],buildingE=["Building/E/First-Floor.html","Building/E/Second-Floor.html","Building/E/Third-Floor.html"],buildingF=["Building/F/First-Floor.html","Building/F/Second-Floor.html"],buildingH=["Building/H/First-Floor.html","Building/H/Second-Floor.html","Building/H/Third-Floor.html"],buildingI=["Building/I/First-Floor.html","Building/I/Second-Floor.html","Building/I/Third-Floor.html"],buildingL=["Building/L/First-Floor.html","Building/L/Second-Floor.html","Building/L/Third-Floor.html"],floors2=["1"],floors3=["1","2","3","4"],floorsA=["1"],floorsB=["1","2","3"],floorsC=["1","2"],floorsC3=["G","1","2"],floorsD=["1","2"],floorsE=["1","2","3"],floorsF=["1","2"],floorsH=["1","2","3"],floorsI=["1","2","3"],floorsL=["1","2","3"],campus={map:"Building/(Campus)/campus.html",buildings:[{id:"2",name:"2000",dir:"Building/2000/",floorIndex:0,floors:[{id:"1",map:"First-Floor.html"}]},{id:"3",name:"3000",dir:"Building/3000/",floorIndex:1,floors:[{id:"1",map:"First-Floor.html"},{id:"2",map:"Second-Floor.html"},{id:"3",map:"Third-Floor.html"},{id:"4",map:"Fourth-Floor.html"}]},{id:"A",name:"Building A",dir:"Building/A/",floorIndex:0,floors:[{id:"1",map:"First-Floor.html"}]},{id:"B",name:"Building B",dir:"Building/B/",floorIndex:0,floors:[{id:"1",map:"first-floor.html"},{id:"2",map:"second-floor.html"},{id:"3",map:"third-floor.html"}]},{id:"C",name:"Building C",dir:"Building/C/",floorIndex:0,floors:[{id:"1",map:"First-Floor.html"},{id:"2",map:"Second-Floor.html"}]},{id:"C3",name:"Building C3",dir:"Building/C3/",floorIndex:1,floors:[{id:"G",map:"Ground-Floor.html"},{id:"1",map:"First-Floor.html"},{id:"2",map:"Second-Floor.html"}]},{id:"D",name:"Building D",dir:"Building/D/",floorIndex:0,floors:[{id:"1",map:"First-Floor.html"},{id:"2",map:"Second-Floor.html"}]},{id:"E",name:"Building E",dir:"Building/E/",floorIndex:0,floors:[{id:"1",map:"First-Floor.html"},{id:"2",map:"Second-Floor.html"},{id:"3",map:"Third-Floor.html"}]},{id:"F",name:"Building F",dir:"Building/F/",floorIndex:0,floors:[{id:"1",map:"First-Floor.html"},{id:"2",map:"Second-Floor.html"}]},{id:"H",name:"Building H",dir:"Building/H/",floorIndex:0,floors:[{id:"1",map:"First-Floor.html"},{id:"2",map:"Second-Floor.html"},{id:"3",map:"Third-Floor.html"}]},{id:"I",name:"Building I",dir:"Building/I/",floorIndex:0,floors:[{id:"1",map:"First-Floor.html"},{id:"2",map:"Second-Floor.html"},{id:"3",map:"Third-Floor.html"}]},{id:"L",name:"Building L",dir:"Building/L/",floorIndex:0,floors:[{id:"1",map:"First-Floor.html"},{id:"2",map:"Second-Floor.html"},{id:"3",map:"Third-Floor.html"}]}]};function getEvents(){debug.group("Getting Events"),Storage.prototype.setObj=function(e,o){this.setItem(e,JSON.stringify(o))};var a=0,i=[],l=new XMLHttpRequest;l.open("GET","https://cors-anywhere.herokuapp.com/http://www.ggc.edu/student-life/events-calendar/events-calendar/summary"),l.send(null),l.onreadystatechange=function(){if(4==l.readyState){for(var e,o=(new DOMParser).parseFromString(l.responseText,"text/html").querySelectorAll(".SECalendarSummaryDate"),n=0;n<o.length;n++)if("SECalendarSummaryDate"!=o[n].className)debug.msg(!1);else if(1<o[n].querySelectorAll(".SECalendarPropertyContainer").length)for(var t=0;t<o[n].querySelectorAll(".SECalendarPropertyContainer").length;t++)e=o[n].querySelectorAll(".SECalendarSummaryDateEventList"),i[a]=new Array(o[n].querySelector("h3").innerText,e[0].children[t].querySelector(".SECalendarEventName").innerText,e[0].children[t].children[0].children[2].innerText,e[0].children[t].children[0].children[4].innerText.replace(/^\s+|\s+$/g,"")),a+=1;else e=o[n].querySelectorAll(".SECalendarPropertyContainer"),i[a]=new Array(o[n].querySelector("h3").innerText,o[n].querySelector(".SECalendarEventName").innerText,e[0].children[2].innerText,e[0].children[4].innerText.replace(/^\s+|\s+$/g,"")),a+=1;localStorage.setObj("event_key",i),localStorage.setObj("eventNumber_key",a);var r=new Date;r.getFullYear(),r.getMonth();localStorage.setObj("event_updated",r.getMonth()+1+"/"+r.getDate()),checkLocalStorage()}},debug.end()}function insertEvents(e,o){debug.group("Insert Events");for(var n=new Date,t=(n.getFullYear(),n.getMonth(),/[a-zA-Z]\-[A-Z|0-9][0-9]+/),r=0;r<o;r++){var a=e[r][0].substring(e[r][0].search(n.toLocaleString("en",{month:"long"}))+n.toLocaleString("en",{month:"long"}).length,e[r][0].lastIndexOf(","));if(a>=n.getDate()&&a<=n.getDate()+14){var i=document.createElement("div");i.className="event";var l=document.createElement("div");l.className="tab-group";var s=document.createElement("h5");s.innerText=e[r][1];var d=document.createElement("p");d.innerText=e[r][0];var u=document.createElement("p");u.innerText=e[r][2];var c=document.createElement("p");c.innerText=e[r][3];var g=document.createElement("a"),m=e[r][3].replace(/ /g,""),p=e[r][3].split(", ");if(1==p[0].includes("(")){var h=p[0].search("\\("),b=p[0].search("\\)");p[0]=p[0].replace(p[0].substr(h-1,b),"")}var f=p[0].split(" "),v=!1,C=document.querySelectorAll("div#campusEvents")[0].children[0].children[2];if(1==t.test(m))g.setAttribute("onclick","closeTab('campusEvents');"),g.setAttribute("href","#"+t.exec(m)[0].replace("-","")),g.appendChild(s),g.appendChild(d),g.appendChild(u),g.appendChild(c),i.appendChild(g),l.appendChild(i),1==t.exec(m)[0].includes("C-G")?i.id="C3":"C"==t.exec(m)[0].substr(0,1)&&1300<parseInt(t.exec(m)[0].substr(2,4))&&parseInt(t.exec(m)[0].substr(2,4))<2e3||"C"==t.exec(m)[0].substr(0,1)&&2300<parseInt(t.exec(m)[0].substr(2,4))&&parseInt(t.exec(m)[0].substr(2,4))<3e3?i.id="C3":i.id=t.exec(m)[0].substr(0,1),C.appendChild(l);else{var E,F;for(var y in roomNames)for(var B in roomNames[y])for(var k in roomNames[y][B])2<=f.length&&1==roomNames[y][B][k].name.includes(f[0].toLowerCase()+"-"+f[1].toLowerCase())?(v=!0,E=roomNames[y][B][k].name,F=y.toUpperCase()):1==f.length&&1==roomNames[y][B][k].name.includes(f[0].toLowerCase())&&(v=!0,E=roomNames[y][B][k].name,F=y.toUpperCase());if(1==v)g.setAttribute("onclick","closeTab('campusEvents');"),g.setAttribute("href","#"+E),i.id=F,g.appendChild(s),g.appendChild(d),g.appendChild(u),g.appendChild(c),i.appendChild(g),l.appendChild(i),C.appendChild(l);else if(1<p.length&&1==p[1].includes("Building")||1<p.length&&1==p[0].includes("Building"))if(1==p[1].includes("Building"))g.setAttribute("onclick","closeTab('campusEvents');"),g.setAttribute("href","#"+p[1].substr(p[1].search("Building")+9)),i.id=p[1].substr(p[1].search("Building")+9),g.appendChild(s),g.appendChild(d),g.appendChild(u),g.appendChild(c),i.appendChild(g),l.appendChild(i),C.appendChild(l);else{g.setAttribute("onclick","closeTab('campusEvents');"),g.setAttribute("href","#"+p[0].substr(p[0].search("Building")+9)+/[A-Z|0-9][0-9]+/.exec(p[1])),i.id=p[0].substr(p[0].search("Building")+9),g.appendChild(s),g.appendChild(d),g.appendChild(u),g.appendChild(c),i.appendChild(g),l.appendChild(i),C.appendChild(l)}else 2==f.length&&1==f[0].includes("Building")&&1==f[1].length?(g.setAttribute("onclick","closeTab('campusEvents');"),g.setAttribute("href","#"+f[1]),i.id=f[1],g.appendChild(s),g.appendChild(d),g.appendChild(u),g.appendChild(c),i.appendChild(g)):1==e[r][3].includes("Student Center")?(g.setAttribute("onclick","closeTab('campusEvents');"),g.setAttribute("href","#E"),i.id="E",g.appendChild(s),g.appendChild(d),g.appendChild(u),g.appendChild(c),i.appendChild(g)):(i.appendChild(s),i.appendChild(d),i.appendChild(u),i.appendChild(c)),l.appendChild(i),C.appendChild(l)}}}debug.end()}function checkLocalStorage(){debug.group("Check Local Storage"),Storage.prototype.getObj=function(e){return JSON.parse(this.getItem(e))};var e=navigator.onLine,o=new Date;o.getFullYear(),o.getMonth();1==e?null==localStorage.getObj("event_key")||null==localStorage.getObj("eventNumber_key")?getEvents():localStorage.getObj("event_updated")!=o.getMonth()+1+"/"+o.getDate()?getEvents():insertEvents(localStorage.getObj("event_key"),localStorage.getObj("eventNumber_key")):null==localStorage.getObj("event_key")||null==localStorage.getObj("eventNumber_key")?debug.msg("No connection to retrieve events"):insertEvents(localStorage.getObj("event_key"),localStorage.getObj("eventNumber_key")),debug.end()}function sortEvents(){debug.group("Sort Events");var e,o=0,n=document.querySelectorAll("div.event");if(document.querySelectorAll("h5.no-events")[0].style.display="none",window.location.hash.length<=2){for(e=0;e<n.length;e++)window.location.hash.substr(1)!=n[e].id?(n[e].style.display="none",o++):window.location.hash.substr(1)==n[e].id&&(n[e].style.display="block");o==n.length&&(document.querySelectorAll("h5.no-events")[0].style.display="block")}else if(1==/[A-Z][A-Z|0-9][0-9]+/.test(window.location.hash.substr(1)))if(1==window.location.hash.includes("CG")||1==window.location.hash.includes("C")&&1300<window.location.hash.substr(2,4)&&window.location.hash.substr(2,4)<1400||1==window.location.hash.includes("C")&&2300<window.location.hash.substr(2,4)&&window.location.hash.substr(2,4)<2400){for(e=0;e<n.length;e++)"C3"==n[e].id?n[e].style.display="block":(n[e].style.display="none",o++);o==n.length&&(document.querySelectorAll("h5.no-events")[0].style.display="block")}else{for(e=0;e<n.length;e++)window.location.hash.substr(1,1)==n[e].id?n[e].style.display="block":(n[e].style.display="none",o++);o==n.length&&(document.querySelectorAll("h5.no-events")[0].style.display="block")}else if("#Campus"==window.location.hash)for(e=0;e<n.length;e++)n[e].style.display="block";else{var t;for(var r in roomNames)for(var a in roomNames[r])for(var i in roomNames[r][a])window.location.hash.substr(1)==roomNames[r][a][i].name&&(t=r,debug.msg(t));for(e=o=0;e<n.length;e++)n[e].id==t?(n[e].style.display="block",o++):n[e].style.display="none";o==n.length&&(document.querySelectorAll("h5.no-events")[0].style.display="block")}openTab("campusEvents"),debug.end()}function cookieMold(e,o,n){debug.group("Cookie Mold");var t=new Date;t.setTime(t.getTime()+24*n*60*60*1e3);var r="expires="+t.toUTCString();document.cookie=e+"="+o+";"+r+";path=/",debug.end()}function eatCookie(e){debug.group("Eat Cookie");for(var o=e+"=",n=decodeURIComponent(document.cookie).split(";"),t=0;t<n.length;t++){for(var r=n[t];" "==r.charAt(0);)r=r.substring(1);if(0===r.indexOf(o))return r.substring(o.length,r.length)}return debug.end(),""}function agreePage(e){debug.group("Agree Page"),document.cookie="agreement="+e,window.location.replace("index.html"),debug.end()}function visitCheck(){(debug.group("Visit Check"),""===eatCookie("visits")||null===eatCookie("visits"))?cookieMold("visits",1,1):(cookieMold("visits",parseInt(eatCookie("visits"))+1,1),"show"===eatCookie("legend")&&(document.getElementById("legendSwitch").checked=!0));debug.end()}function cookieLegend(){debug.group("Cookie Legend");var e=eatCookie("legend").toUpperCase();if(null!==eatCookie("legend"))switch(e){case"HIDE":cookieMold("legend","show",9999),debug.msg("Now Showing");break;case"SHOW":cookieMold("legend","hide",9999),debug.msg("Now Hiding");break;default:debug.msg("Done changing")}debug.end()}function firstLegend(){debug.group("First Legend"),""!==eatCookie("visits")&&null!==eatCookie("visits")||cookieMold("legend","hide",9999),debug.end()}var debug={active:!0,group:function(e){this.active&&console.group(e)},end:function(){console.groupEnd()},msg:function(e){this.active&&console.log(e)},error:function(e){this.active&&console.error(e)}};function switchMap(e){debug.group("Switch Map");var o={map:"",building:"",floor:"",room:""},n=parseSearch(e);o.room=n.room,"campus"===n.building.toLowerCase()&&(o.map=campus.map,o.building="Campus");for(var t=0;t<campus.buildings.length;t++)if(n.building.toUpperCase()===campus.buildings[t].id.toUpperCase()){if(o.building=campus.buildings[t].id,debug.msg("Building= "+o.building),null===n.room&&void 0===n.room){o.floor=campus.buildings[t].floors[0].id,o.map=campus.buildings[t].dir+campus.buildings[t].floors[0].map,debug.msg("Floor= "+o.floor),debug.msg("Map= "+o.map);break}for(var r=0;r<campus.buildings[t].floors.length;r++)if(n.room[campus.buildings[t].floorIndex].toUpperCase()===campus.buildings[t].floors[r].id.toUpperCase()){o.floor=campus.buildings[t].floors[r].id,o.map=campus.buildings[t].dir+campus.buildings[t].floors[r].map,debug.msg("Floor= "+o.floor),debug.msg("Map= "+o.map);break}}return""===o.map&&debug.error("Map not set"),debug.end(),o}function addMap(e,s,d){debug.group("Add Map");var u=document.getElementById("building"),c=document.getElementById("floor"),g=document.getElementById("svg-holder");return new Promise(function(a,i){var l=new XMLHttpRequest;l.open("GET",e,!0),l.onload=function(){if(200!==l.status&&i(Error(l.statusText)),s!==u){var e=document.getElementById("building-popup"),o=document.getElementsByClassName("dropdown")[0],n=document.getElementsByClassName("campus-info")[0];"Campus"===s?(hideElement(e,HIDE),"show"===eatCookie("legend")?(hideElement(n,SHOW),document.getElementById("pLegend").style.display="inherit"):(hideElement(n,HIDE),document.getElementById("pLegend").style.display="none")):(hideElement(e,SHOW),hideElement(n,HIDE)),void 0!==d?(hideElement(c,SHOW),hideElement(o,SHOW),floorDropDown(s),c.innerHTML="FL"+d):(hideElement(c,HIDE),hideElement(o,HIDE))}removeMap(),g.appendChild(convertToElement(l.response));var t=g.childNodes[0];t.style.height=getClientHeight(),u.innerHTML=s;var r=svgPanZoom(t,{controlIconsEnabled:!0,fit:1,center:1,customEventsHandler:{haltEventListeners:["touchStart","touchend","touchmove","touchleave","touchcancel"],init:function(e){var o=e.instance,n=1,t=0,r=0;this.hammer=Hammer(e.svgElement,{inputClass:Hammer.SUPPORT_POINTER_EVENTS?Hammer.PointerEventInput:Hammer.TouchInput}),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("doubletap",function(e){o.zoomIn()}),this.hammer.on("panstart panmove",function(e){"panstart"===e.type&&(r=t=0),o.panBy({x:e.deltaX-t,y:e.deltaY-r}),t=e.deltaX,r=e.deltaY}),this.hammer.on("pinchstart pinchmove",function(e){"pinchstart"===e.type&&(n=o.getZoom(),o.zoom(n*e.scale)),o.zoom(n*e.scale)}),this.hammer.on("tap",function(e){if(toggleTab(e,"helpbox"),toggleTab(e,"campusEvents"),"Campus"===s){var o=e.target.parentNode.id.toUpperCase();if("A"===o)changeFloor(o);else if("C3"===o)changeFloor(o,"G");else for(var n in roomNames)o===n&&changeFloor(n,"1")}else{var t=e.target.parentNode.id;4!==t.length&&5!==t.length||(debug_msg("addMap calls activateRoom"),activateRoom(e.target.parentNode.id))}}),e.svgElement.addEventListener("touchmove",function(e){e.preventDefault()})},destroy:function(){this.hammer.destroy()}}});window.addEventListener("resize",function(){t.style.height=getClientHeight(),r.resize(),r.fit(),r.center()}),a(l.response)},l.onerror=function(){i(Error("Network Error"))},l.send(),debug.end()})}function removeMap(){debug.group("Remove Map");for(var e=document.getElementById("svg-holder");e.hasChildNodes();)e.removeChild(e.lastChild);debug.end()}function openMenu(){debug.group("Open Menu");var e=document.getElementsByClassName("nav")[0],o=document.getElementsByClassName("content-disable")[0];"nav"===e.className&&(e.classList.add("nav-active"),o.classList.add("active")),debug.end()}function closeMenu(){debug.group("Close Menu");var e=document.getElementsByClassName("nav")[0],o=document.getElementsByClassName("content-disable")[0];"nav nav-active"===e.className&&(e.classList.remove("nav-active"),o.classList.remove("active"));var n=document.getElementsByClassName("floors")[0];"floors floors-active"===n.className&&n.classList.remove("floors-active"),debug.end()}function subMenu(e){debug.group("Sub Menu");var o=document.getElementsByClassName(e)[0];o.className===e?o.classList.add("subMenu-active"):o.className===e+" subMenu-active"&&o.classList.remove("subMenu-active"),debug.end()}var urlTimer,HIDE=!0,SHOW=!1;function urlRoom(){if(debug.group("URL Room"),-1<window.navigator.userAgent.indexOf("Edge"));else{var e=window.location.hash,o=e.substring(e.lastIndexOf("#")+1);if(""===o||o.includes(".")||"campus"===o.toLowerCase())addMap(campusMap,"Campus").then(function(e){window.location.hash="Campus",document.getElementById("search").value=""},function(e){debug_error("Failed!",e)});else switch(o.toUpperCase()){case"2":changeFloor("2");break;case"3":changeFloor("3","1");break;case"A":changeFloor("A");break;case"B":changeFloor("B","1");break;case"C":changeFloor("C","1");break;case"C3":changeFloor("C3","G");break;case"D":changeFloor("D","1");break;case"E":changeFloor("E","1");break;case"F":changeFloor("F","1");break;case"H":changeFloor("H","1");break;case"I":changeFloor("I","1");break;case"L":changeFloor("L","1");break;case"G":case"J":case"K":case"M":case"N":case"O":case"P":case"Q":case"R":case"S":case"T":case"U":case"V":case"W":case"X":case"Y":case"Z":window.location.hash="Campus";break;default:debug.msg("urlRoom calls searchFromMenu"),searchFromMenu(o)}}debug.end()}function floorDropDown(e){debug.group("Floor DropDown");for(var o=document.getElementsByClassName("floors")[0];o.hasChildNodes();)o.removeChild(o.lastChild);var n=[];switch(e){case"2":n=floors2;break;case"3":n=floors3;break;case"A":n=floorsA;break;case"B":n=floorsB;break;case"C":n=floorsC;break;case"C3":n=floorsC3;break;case"D":n=floorsD;break;case"E":n=floorsE;break;case"F":n=floorsF;break;case"H":n=floorsH;break;case"I":n=floorsI;break;case"L":n=floorsL}for(var t=0;t<n.length;t++){var r="<h2 onclick=\"changeFloor('"+e+"', '"+n[t]+"')\">Floor "+n[t]+"</h2>";o.appendChild(convertToElement(r))}debug.end()}function activateRoom(e,o){if(debug.group("Activate Room"),"4983"!==e){var n="room-group",t=document.getElementById(e.toLowerCase());if(null===t)alert("Sorry, room number "+e+" couldn't be found in this building.");else{var r=t.className.baseVal;if(r!==n&&!o)return r===n+" active-room"?void deactivateAllRooms():void 0;r===n&&(deactivateAllRooms(),t.classList.add("active-room"))}debug.end()}}function deactivateAllRooms(){debug.group("Deactivate All Rooms");for(var e=document.getElementsByClassName("room-group"),o=0;o<e.length;o++)e[o].classList.remove("active-room");debug.end()}function getMap(e,o){debug.group("Get Map");var n="";switch(e){case"Campus":n=campusMap;break;case"2":n=building2[0];break;case"3":n="4"===o?building3[3]:"3"===o?building3[2]:"2"===o?building3[1]:building3[0];break;case"A":n=buildingA[0];break;case"B":n="3"===o?buildingB[2]:"2"===o?buildingB[1]:buildingB[0];break;case"C":n="1"===o?buildingC[0]:buildingC[1];break;case"C3":n="2"===o?buildingC3[2]:"1"===o?buildingC3[1]:buildingC3[0];break;case"D":n="2"===o?buildingD[1]:buildingD[0];break;case"E":n="3"===o?buildingE[2]:"2"===o?buildingE[1]:buildingE[0];break;case"F":n="2"===o?buildingF[1]:buildingF[0];break;case"H":n="3"===o?buildingH[2]:"2"===o?buildingH[1]:buildingH[0];break;case"I":n="3"===o?buildingI[2]:"2"===o?buildingI[1]:buildingI[0];break;case"L":n="3"===o?buildingL[2]:"2"===o?buildingL[1]:buildingL[0]}return debug.msg("getMap returning"),debug.end(),n}function changeFloor(o,e){debug.group("Change Floor"),closeMenu();var n=o.toUpperCase();(document.getElementById("roomSearch").value="")!==(n=getMap(o,e))&&addMap(n,o,e).then(function(e){window.location.hash=o,debug.msg("urlRoom stopped by changeFloor"),clearTimeout(urlTimer)},function(e){debug.error("Failed!",e)}),safetyOff(),debug.end()}function searchSuggest(e){debug.group("Search Suggest");var o=document.getElementById("roomSearch").value.toUpperCase();roomList=document.getElementById("rooms");var n=[],t=[],r="undefined"!=typeof InstallTrigger,a="";if(loadSearch("Building\\AllRooms.txt"),n=document.getElementById("arrayStore").value.split(","),debug.msg(o),r){if(""==roomList.innerHTML){for(var i=0;i<n.length-1;i++)a+='<option value="'+n[i]+'" />';roomList.innerHTML="<select>"+a+"</select>"}}else{for(var l=0;l<=n.length-1;l++)n[l].includes(o)&&t.push(n[l]);debug.msg(t);for(var s=0;s<4&&s<=t.length-1;s++)a+='<option value="'+t[s]+'" />';roomList.innerHTML="<select>"+a+"</select>"}debug.end()}function loadSearch(t){return new Promise(function(e,o){debug.group("Load Search");var n=new XMLHttpRequest;n.open("GET",t,!0),n.onload=function(){200!==n.status&&o(Error(n.statusText)),document.getElementById("arrayStore").value=n.responseText.split("\n"),e(n.response)},n.onerror=function(){o(Error("Network Error"))},n.send(),debug.end()})}function searchFromBar(e){debug.group("Search From Bar"),13!=e.which&&13!=e.keyCode||(debug.msg("searchFromBar calls searchRoomNumber"),searchRoomNumber()),debug.end()}function searchFromMenu(e){debug.group("Search From Menu"),closeMenu(),debug.msg("searchFromMenu calls parseSearch");var o=parseSearch(e);""!==o.roomName?document.getElementById("roomSearch").value=o.roomName:document.getElementById("roomSearch").value=o.building+" "+o.room,debug.msg("searchFromMenu calls searchRoomNumber"),searchRoomNumber(),debug.end()}function searchRoomNumber(){debug.group("Search Room Number");var e=parseSearch(document.getElementById("roomSearch").value.toUpperCase());if(debug.msg("building = "+e.building),"campus"===e.roomName.toLowerCase())document.getElementById("roomSearch").value="",changeFloor("Campus");else{var o="4983",n=document.getElementById("building").innerHTML,t=n,r=document.getElementById("floor").innerHTML,a="",i="";if(""!==e.building&&(n=e.building),""!==e.room&&(o=e.room),""!==e.roomName){for(var l in o="",roomNames){var s=l;for(var d in roomNames[l]){var u=d;for(var c in roomNames[l][d]){var g=roomNames[l][d][c];g.name.toLowerCase()===e.roomName.toLowerCase()&&(a=s,i=u,o=g.id)}}}""===o?alert('Were you trying to search by nickname? Unfortunately, "'+e.roomName+'" is not recognized.\nPlease check your spelling, or try a more common name.\n\nExample: Search for "Moes" not "Mo"'):window.location.hash=e.roomName}else{switch(debug.group("upperHash"),window.location.hash="4983"!==o?n.toUpperCase()+o.toUpperCase():n.toUpperCase(),debug.msg("urlRoom stopped by upperHash()"),clearTimeout(urlTimer),debug.end(),n[0].toUpperCase()){case"2":a="2",i=void 0;break;case"3":"4"===o[1]?(a="3",i="4"):"3"===o[1]?i=a="3":"2"===o[1]?(a="3",i="2"):(a="3",i="1");break;case"A":a="A",i=void 0;break;case"B":"3"===o[0]?(a="B",i="3"):"2"===o[0]?(a="B",i="2"):(o[0],a="B",i="1");break;case"C":"3"===o[1]?"2"===o[0]?(a="C3",i="2"):"1"===o[0]?(a="C3",i="1"):(a="C3",i="G"):"2"===o[0]?(a="C",i="2"):(a="C",i="1");break;case"D":"2"===o[0]?(a="D",i="2"):(o[0],a="D",i="1");break;case"E":"3"===o[0]?(a="E",i="3"):"2"===o[0]?(a="E",i="2"):(o[0],a="E",i="1");break;case"F":"2"===o[0]?(a="F",i="2"):(o[0],a="F",i="1");break;case"H":"3"===o[0]?(a="H",i="3"):"2"===o[0]?(a="H",i="2"):(o[0],a="H",i="1");break;case"I":"3"===o[0]?(a="I",i="3"):"2"===o[0]?(a="I",i="2"):(o[0],a="I",i="1");break;case"L":"3"===o[0]?(a="L",i="3"):"2"===o[0]?(a="L",i="2"):(o[0],a="L",i="1");break;case"G":case"J":case"K":case"M":case"N":case"O":case"P":case"Q":case"R":case"S":case"T":case"U":case"V":case"W":case"X":case"Y":case"Z":if("0"===o[0]||"1"===o[0]||"2"===o[0]||"3"===o[0]||"4"===o[0]||"5"===o[0]||"6"===o[0]||"7"===o[0]||"8"===o[0]||"9"===o[0]){alert("Did you mean to search for building "+n+"?\nThat building doesn't exist.");break}alert(n+" is an invalid building."),changeFloor("Campus");break;default:alert("I'm sorry, "+n+" is a character we don't understand.")}}t!==a||r!==i?(debug.msg("searchRoomNumber calls searchNewFloor"),searchNewFloor(a,i,o)):(debug.msg("searchRoomNumber calls activateRoom"),activateRoom(o,!0))}debug.end()}function searchNewFloor(e,o,n){debug.group("Search New Floor");var t=e,r=document.getElementById("building"),a=document.getElementById("floor");r.innerHTML===e&&a.innerHTML===o||(debug.msg("searchNewFloor calls getMap"),""!==(t=getMap(e.toUpperCase(),o))&&(debug.msg("searchNewFloor calls addMap"),addMap(t,e,o).then(function(e){debug.msg("searchNewFloor calls activateRoom"),activateRoom(n,!0)},function(e){debug.error("Failed!",e)}))),debug.end()}var roomNames,roomNameFile="js/roomNames.json",helpFile="help.html",campusEventsFile="campusEvents.html";function loadRooms(){return new Promise(function(e,o){debug.group("Load Rooms");var n=new XMLHttpRequest;n.open("GET",roomNameFile,!0),n.onload=function(){200!==n.status&&o(Error(n.statusText)),roomNames=JSON.parse(n.response),e(n.response)},n.onerror=function(){o(Error("Network Error"))},n.send(),debug.end()})}function openTab(e){debug.group("Open Tab"),closeMenu();var o=document.getElementById(e);if(!o.classList.contains("tab-active")){o.classList.toggle("tab-active");var n=tabContentHeight(e);o.childNodes[0].childNodes[7].style.height=n+"px"}debug.end()}function closeTab(e){debug.group("Close Tab");var o=document.getElementById(e);o.classList.contains("tab-active")&&o.classList.toggle("tab-active"),debug.end()}function tabContentHeight(e){debug.group("Tab Content Height");var o=window.innerHeight||document.body.clientHeight,n=document.getElementById(e).childNodes[0].childNodes[1].clientHeight;return debug.end(),o-n}function isLetter(e){return e.toLowerCase()!==e.toUpperCase()}function isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}function parseSearch(e){debug.group("Parse Search");for(var o=e.split(/[ \+-\s<>'"();/\\]+/),n="",t="",r="",a=0;a<o.length;a++)1===o[a].length&&isLetter(o[a])&&0===a?n=o[a]:4===o[a].length?isNumeric(o[a])?"2000"==o[a]||"3000"==o[a]?n=o[a][0]:t=o[a]:"G"===o[a].charAt(0)&&isNumeric(o[a].substring(1))?(t=o[a],n="C"):(""!==r&&(r+="-"),r+=o[a]):5===o[a].length?isNumeric(o[a].substring(1))?(t=o[a].substring(1),n=o[a].charAt(0)):isNumeric(o[a].substring(0,4))?t=o[a]:(""!==r&&(r+="-"),r+=o[a]):6===o[a].length&&isNumeric(o[a].substring(1,5))?(t=o[a].substring(1),n=o[a].charAt(0)):(""!==r&&(r+="-"),r+=o[a]);""===n&&""===t&&""!==r&&isLetter(e[0])&&isNumeric(e[2])&&(n=e[0],t=e.substring(1),r="");var i={building:n,room:t,roomName:r.toLowerCase()};return debug.end(),i}function activatePopup(e,o){debug.group("Activate Popup"),e.onmouseover=function(){document.getElementById(o).classList.toggle("popup-active")},e.onmouseout=function(){document.getElementById(o).classList.toggle("popup-active")},debug.end()}function convertToElement(e){debug.group("Convert to Element");var o=document.createElement("div");return o.innerHTML=e,debug.end(),o.childNodes[0]}function getClientHeight(){return(window.innerHeight||document.body.clientHeight)+"px"}function dropdown(e,o){debug.group("Drop Down"),document.getElementsByClassName(e)[0].classList.toggle(o),debug.end()}function resetWidth(e){debug.group("Reset Width"),debug.msg("resize"),e.resize(),e.fit(),e.center(),debug.end()}function hideElement(e,o){debug.group("Hide Element"),o?e.classList.contains("hide")||e.classList.toggle("hide"):e.classList.contains("hide")&&e.classList.toggle("hide"),debug.end()}function loadFile(t,r){return new Promise(function(e,o){debug.group("Load File");var n=new XMLHttpRequest;n.open("GET",r,!0),n.onload=function(){200!==n.status&&o(Error(n.statusText)),document.getElementById(t).appendChild(convertToElement(n.response)),e(n.response)},n.onerror=function(){o(Error("Network Error"))},n.send(),debug.end()})}function toggleTab(e,o){debug.group("Toggle Tab");var n=document.getElementById(o);!isDescendant(n,e.target)&&n.classList.contains("tab-active")&&n.classList.toggle("tab-active"),debug.end()}function isDescendant(e,o){debug.group("Is Decendant");for(var n=o.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return debug.end(),!1}document.addEventListener("DOMContentLoaded",function(){debug.group("DOM Content Loaded"),loadRooms().then(function(e){},function(e){debug.error("Failed!",e)}),loadFile("helpbox",helpFile).then(function(e){},function(e){debug.error("Failed!",e)}),loadFile("campusEvents",campusEventsFile).then(function(e){checkLocalStorage()},function(e){debug.error("Failed!",e)});var e=document.getElementById("building"),o=document.getElementById("floor"),n=document.getElementById("menu"),t=document.getElementById("search");activatePopup(e,"building-popup"),activatePopup(o,"floor-popup"),activatePopup(n,"menu-popup"),activatePopup(t,"search-popup"),urlRoom(),window.addEventListener("popstate",function(e){debug.msg("website auto calls urlRoom"),urlTimer=setTimeout(function(){urlRoom()},100)}),debug.end()});